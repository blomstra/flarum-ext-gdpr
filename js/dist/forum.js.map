{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/gdpr/webpack/bootstrap","webpack://@flarum/gdpr/webpack/runtime/compat get default export","webpack://@flarum/gdpr/webpack/runtime/define property getters","webpack://@flarum/gdpr/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/gdpr/webpack/runtime/make namespace object","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/states/PaginatedListState')\"","webpack://@flarum/gdpr/./src/forum/states/ErasureRequestsListState.ts","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/utils/ItemList')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/FieldSet')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@flarum/gdpr/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@flarum/gdpr/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@flarum/gdpr/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@flarum/gdpr/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/Form')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/FormModal')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/utils/extractText')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@flarum/gdpr/./src/forum/components/RequestErasureModal.tsx","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/Modal')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/helpers/username')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/Avatar')\"","webpack://@flarum/gdpr/./src/common/components/RequestDataExportModal.tsx","webpack://@flarum/gdpr/./src/forum/extenders/extendUserSettingsPage.tsx","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/components/HeaderSecondary')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/components/NotificationsDropdown')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/Component')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/components/HeaderList')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/components/HeaderListItem')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/components/UserCard')\"","webpack://@flarum/gdpr/./src/forum/components/ProcessErasureRequestModal.tsx","webpack://@flarum/gdpr/./src/forum/components/ErasureRequestsList.tsx","webpack://@flarum/gdpr/./src/forum/components/ErasureRequestsDropdown.tsx","webpack://@flarum/gdpr/./src/forum/extenders/extendHeaderSecondary.tsx","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/Page')\"","webpack://@flarum/gdpr/./src/forum/extenders/extendPage.ts","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/utils/UserControls')\"","webpack://@flarum/gdpr/./src/forum/components/DeleteUserModal.tsx","webpack://@flarum/gdpr/./src/forum/extenders/extendUserControls.tsx","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/models/User')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/components/Badge')\"","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/extenders')\"","webpack://@flarum/gdpr/./src/forum/components/ErasureRequestsPage.js","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'common/Model')\"","webpack://@flarum/gdpr/./src/common/models/ErasureRequest.ts","webpack://@flarum/gdpr/./src/common/models/Export.ts","webpack://@flarum/gdpr/./src/common/extend.ts","webpack://@flarum/gdpr/external root \"flarum.reg.get('core', 'forum/components/Notification')\"","webpack://@flarum/gdpr/./src/forum/components/ExportAvailableNotification.ts","webpack://@flarum/gdpr/./src/forum/extend.ts","webpack://@flarum/gdpr/./src/forum/index.ts","webpack://@flarum/gdpr/./src/forum/extenders/addAnonymousBadges.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/states/PaginatedListState');","import app from 'flarum/forum/app';\nimport PaginatedListState from 'flarum/common/states/PaginatedListState';\nexport default class ErasureRequestsListState extends PaginatedListState {\n  constructor() {\n    super({}, 1, null);\n  }\n  get type() {\n    return 'user-erasure-requests';\n  }\n\n  /**\n   * Load flags into the application's cache if they haven't already\n   * been loaded.\n   */\n  load() {\n    var _app$session$user;\n    if ((_app$session$user = app.session.user) != null && _app$session$user.attribute('erasureRequestCount')) {\n      this.pages = [];\n      this.location = {\n        page: 1\n      };\n    }\n    if (this.pages.length > 0) {\n      return Promise.resolve();\n    }\n    return super.loadNext();\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/states/ErasureRequestsListState', ErasureRequestsListState);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/ItemList');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/FieldSet');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Form');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/FormModal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/extractText');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/Stream');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Form from 'flarum/common/components/Form';\nimport app from 'flarum/forum/app';\nimport FormModal from 'flarum/common/components/FormModal';\nimport Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nexport default class RequestErasureModal extends FormModal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"reason\", void 0);\n    _defineProperty(this, \"password\", void 0);\n    _defineProperty(this, \"user\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.reason = Stream('');\n    this.password = Stream('');\n    this.user = app.session.user;\n  }\n  className() {\n    return 'RequestErasureModal Modal--small';\n  }\n  title() {\n    return app.translator.trans('flarum-gdpr.forum.request_erasure.title');\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(Form, {\n      className: \"Form--centered\"\n    }, this.fields().toArray()));\n  }\n  fields() {\n    var _this$user;\n    const items = new ItemList();\n    const currRequest = (_this$user = this.user) == null ? void 0 : _this$user.erasureRequest();\n    if (currRequest && currRequest.status() !== 'cancelled') {\n      items.add('status', m(\"div\", {\n        className: \"Form-group\"\n      }, m(\"p\", {\n        className: \"helpText\"\n      }, app.translator.trans(\"flarum-gdpr.forum.request_erasure.status.\".concat(currRequest.status())))));\n      if (currRequest.reason()) {\n        items.add('reason', m(\"div\", {\n          className: \"Form-group\"\n        }, m(\"p\", {\n          className: \"helpText\"\n        }, app.translator.trans('flarum-gdpr.forum.request_erasure.reason', {\n          reason: currRequest.reason()\n        }))));\n      }\n      items.add('cancel', m(\"div\", {\n        className: \"Form-group\"\n      }, Button.component({\n        className: 'Button Button--primary Button--block',\n        onclick: this.oncancel.bind(this),\n        loading: this.loading\n      }, app.translator.trans('flarum-gdpr.forum.request_erasure.cancel_button'))));\n    } else {\n      items.add('text', m(\"p\", {\n        className: \"helpText\"\n      }, app.translator.trans('flarum-gdpr.forum.request_erasure.text')));\n      if (!app.forum.attribute('passwordlessSignUp')) {\n        items.add('password', m(\"div\", {\n          className: \"Form-group\"\n        }, m(\"input\", {\n          type: \"password\",\n          className: \"FormControl\",\n          bidi: this.password,\n          placeholder: extractText(app.translator.trans('flarum-gdpr.forum.request_erasure.password_label'))\n        })));\n      }\n      items.add('reason', m(\"div\", {\n        className: \"Form-group\"\n      }, m(\"textarea\", {\n        className: \"FormControl\",\n        value: this.reason(),\n        oninput: e => {\n          const target = e.target;\n          if (target) {\n            this.reason(target.value);\n          }\n        },\n        placeholder: extractText(app.translator.trans('flarum-gdpr.forum.request_erasure.reason_label')),\n        rows: 6\n      })));\n      items.add('submit', m(\"div\", {\n        className: \"Form-group\"\n      }, Button.component({\n        className: 'Button Button--primary Button--block',\n        type: 'submit',\n        loading: this.loading\n      }, app.translator.trans('flarum-gdpr.forum.request_erasure.request_button'))));\n    }\n    return items;\n  }\n  oncancel(e) {\n    this.loading = true;\n    m.redraw();\n    if (this.user) {\n      const request = this.user.erasureRequest();\n      app.request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/user-erasure-requests/' + request.id() + '/cancel'\n      }).then(() => {\n        this.loading = false;\n        app.modal.close();\n      });\n    }\n  }\n  data() {\n    // Status is set so that the proper confirmation message is displayed.\n    return {\n      reason: this.reason()\n    };\n  }\n  onsubmit(e) {\n    e.preventDefault();\n    this.loading = true;\n    app.store.createRecord('user-erasure-requests').save(this.data(), {\n      meta: {\n        password: this.password()\n      }\n    }).then(erasureRequest => {\n      if (this.user) {\n        this.user.pushData({\n          relationships: {\n            erasureRequest\n          }\n        });\n      }\n      this.loading = false;\n      m.redraw();\n    }).catch(() => {\n      this.loading = false;\n      m.redraw();\n    });\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/RequestErasureModal', RequestErasureModal);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Modal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/helpers/username');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Avatar');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Form from 'flarum/common/components/Form';\nimport app from 'flarum/common/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport username from 'flarum/common/helpers/username';\nimport Avatar from 'flarum/common/components/Avatar';\nexport default class RequestDataExportModal extends Modal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"user\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.user = this.attrs.user;\n  }\n  className() {\n    return 'RequestDataModal Modal--small';\n  }\n  title() {\n    return app.translator.trans('flarum-gdpr.lib.request_data.title', {\n      username: username(this.user)\n    });\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(Form, {\n      className: \"Form--centered\"\n    }, m(\"div\", {\n      className: \"User\"\n    }, m(Avatar, {\n      user: this.user\n    })), m(\"p\", {\n      className: \"helpText\"\n    }, app.translator.trans('flarum-gdpr.lib.request_data.text')), m(\"div\", {\n      className: \"Form-group\"\n    }, m(Button, {\n      className: \"Button Button--primary Button--block\",\n      onclick: () => this.requestExport(),\n      loading: this.loading,\n      disabled: this.loading\n    }, app.translator.trans('flarum-gdpr.lib.request_data.request_button')))));\n  }\n  requestExport() {\n    this.loading = true;\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/gdpr-exports',\n      body: {\n        data: {\n          attributes: {\n            userId: this.user.id()\n          }\n        }\n      }\n    }).then(this.hide.bind(this), this.loaded.bind(this));\n  }\n}\nflarum.reg.add('flarum-gdpr', 'common/components/RequestDataExportModal', RequestDataExportModal);","import app from 'flarum/forum/app';\nimport { extend, override } from 'flarum/common/extend';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport FieldSet from 'flarum/common/components/FieldSet';\nimport Button from 'flarum/common/components/Button';\nimport RequestErasureModal from '../components/RequestErasureModal';\nimport RequestDataExportModal from '../../common/components/RequestDataExportModal';\nexport default function extendUserSettingsPage() {\n  extend('flarum/forum/components/SettingsPage', 'settingsItems', function (items) {\n    const user = this.user;\n    if (!user) {\n      return;\n    }\n    items.add('dataItems', m(FieldSet, {\n      className: \"Settings-gdpr FieldSet--form\",\n      label: app.translator.trans('flarum-gdpr.forum.settings.data.heading')\n    }, this.dataItems().toArray()), -100);\n  });\n  override('flarum/forum/components/SettingsPage', 'dataItems', function () {\n    const items = new ItemList();\n    items.add('gdprErasure', m(\"div\", {\n      className: \"Form-group gdprErasure-container\"\n    }, m(\"p\", {\n      className: \"helpText\"\n    }, app.translator.trans('flarum-gdpr.forum.settings.request_erasure_help')), m(Button, {\n      className: \"Button Button-gdprErasure\",\n      icon: \"fas fa-user-minus\",\n      onclick: () => app.modal.show(RequestErasureModal)\n    }, app.translator.trans('flarum-gdpr.forum.settings.request_erasure_button'))), 50);\n    items.add('gdprExport', m(\"div\", {\n      className: \"Form-group gdprExport-container\"\n    }, m(\"p\", {\n      className: \"helpText\"\n    }, app.translator.trans('flarum-gdpr.forum.settings.export_data_help')), m(Button, {\n      className: \"Button Button-gdprExport\",\n      icon: \"fas fa-file-export\",\n      onclick: () => app.modal.show(RequestDataExportModal, {\n        user: this.user\n      })\n    }, app.translator.trans('flarum-gdpr.forum.settings.export_data_button'))), 40);\n    return items;\n  });\n}\nflarum.reg.add('flarum-gdpr', 'forum/extenders/extendUserSettingsPage', extendUserSettingsPage);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/HeaderSecondary');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/NotificationsDropdown');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Component');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/HeaderList');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/HeaderListItem');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/UserCard');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Form from 'flarum/common/components/Form';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport username from 'flarum/common/helpers/username';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport FormModal from 'flarum/common/components/FormModal';\nexport default class ProcessErasureRequestModal extends FormModal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"comments\", void 0);\n    _defineProperty(this, \"loadingAnonymization\", false);\n    _defineProperty(this, \"loadingDeletion\", false);\n    _defineProperty(this, \"request\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.request = this.attrs.request;\n    this.comments = Stream('');\n  }\n  className() {\n    return 'ProcessErasureRequestModal Modal--medium';\n  }\n  title() {\n    return app.translator.trans('flarum-gdpr.forum.process_erasure.title');\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(Form, {\n      className: \"Form--centered\"\n    }, this.fields().toArray()));\n  }\n  fields() {\n    const items = new ItemList();\n    const erasureRequest = this.attrs.request;\n    items.add('text', m(\"div\", null, m(UserCard, {\n      className: \"UserCard--popover UserCard--gdpr\",\n      controlsButtonClassName: \"Button\",\n      user: this.request.user()\n    }), m(\"p\", {\n      className: \"helpText\"\n    }, app.translator.trans('flarum-gdpr.forum.process_erasure.text', {\n      name: username(this.request.user())\n    }))));\n    (erasureRequest == null ? void 0 : erasureRequest.reason()) && items.add('reason', m(\"p\", {\n      className: \"helpText\"\n    }, m(\"code\", null, erasureRequest.reason())));\n    items.add('comments', m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"textarea\", {\n      className: \"FormControl\",\n      value: this.comments(),\n      bidi: this.comments,\n      placeholder: extractText(app.translator.trans('flarum-gdpr.forum.process_erasure.comments_label'))\n    })));\n    if (app.forum.attribute('erasureAnonymizationAllowed')) {\n      items.add('anonymize', m(\"div\", {\n        className: \"Form-group\"\n      }, Button.component({\n        className: 'Button Button--primary Button--block',\n        loading: this.loadingAnonymization,\n        onclick: () => this.process('anonymization')\n      }, app.translator.trans('flarum-gdpr.forum.process_erasure.anonymization_button'))));\n    }\n    if (app.forum.attribute('erasureDeletionAllowed')) {\n      items.add('delete', m(\"div\", {\n        className: \"Form-group\"\n      }, Button.component({\n        className: 'Button Button--danger Button--block',\n        loading: this.loadingDeletion,\n        onclick: () => this.process('deletion')\n      }, app.translator.trans('flarum-gdpr.forum.process_erasure.deletion_button'))));\n    }\n    return items;\n  }\n  process(mode) {\n    if (!confirm(app.translator.trans('flarum-gdpr.forum.process_erasure.confirm', {\n      name: extractText(username(this.request.user())),\n      mode\n    }, true))) {\n      return;\n    }\n    if (mode === 'anonymization') {\n      this.loadingAnonymization = true;\n    } else {\n      this.loadingDeletion = true;\n    }\n    m.redraw();\n    this.request.save({\n      processedMode: mode,\n      processorComment: this.comments()\n    }).then(erasureRequest => {\n      app.store.remove(erasureRequest);\n      this.loadingAnonymization = false;\n      this.loadingDeletion = false;\n      m.redraw();\n      this.hide();\n    }).catch(() => {\n      this.loadingAnonymization = false;\n      this.loadingDeletion = false;\n      m.redraw();\n    });\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/ProcessErasureRequestModal', ProcessErasureRequestModal);","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport Avatar from 'flarum/common/components/Avatar';\nimport username from 'flarum/common/helpers/username';\nimport HeaderList from 'flarum/forum/components/HeaderList';\nimport HeaderListItem from 'flarum/forum/components/HeaderListItem';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport ProcessErasureRequestModal from './ProcessErasureRequestModal';\nexport default class ErasureRequestsList extends Component {\n  view() {\n    const state = this.attrs.state;\n    return m(HeaderList, {\n      className: \"ErasureRequestsList\",\n      title: app.translator.trans('flarum-gdpr.forum.erasure_requests.title'),\n      controls: this.controlItems(),\n      hasItems: state.hasItems(),\n      loading: state.isLoading(),\n      emptyText: app.translator.trans('flarum-gdpr.forum.erasure_requests.empty_text'),\n      loadMore: () => state.hasNext() && !state.isLoadingNext() && state.loadNext()\n    }, m(\"ul\", {\n      className: \"HeaderListGroup-content\"\n    }, this.content(state)));\n  }\n  showModal(request) {\n    app.modal.show(ProcessErasureRequestModal, {\n      request\n    });\n  }\n  controlItems() {\n    const items = new ItemList();\n    return items;\n  }\n  content(state) {\n    if (!state.isLoading() && state.hasItems()) {\n      return state.getPages().map(page => {\n        return page.items.map((request, index) => {\n          return m(\"li\", null, m(HeaderListItem, {\n            key: index,\n            className: \"EraseRequest\",\n            onclick: this.showModal.bind(this, request),\n            avatar: m(Avatar, {\n              user: request.user()\n            }),\n            icon: \"fas fa-user-edit\",\n            content: app.translator.trans(\"flarum-gdpr.forum.erasure_requests.item_text\", {\n              name: username(request.user())\n            }),\n            datetime: request.createdAt(),\n            excerpt: \"\"\n          }));\n        });\n      });\n    }\n    return null;\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/ErasureRequestsList', ErasureRequestsList);","import app from 'flarum/forum/app';\nimport NotificationsDropdown from 'flarum/forum/components/NotificationsDropdown';\nimport ErasureRequestsList from './ErasureRequestsList';\nexport default class ErasureRequestsDropdown extends NotificationsDropdown {\n  static initAttrs(attrs) {\n    attrs.label = attrs.label || app.translator.trans('flarum-gdpr.forum.erasure_requests.tooltip');\n    attrs.icon = attrs.icon || 'fas fa-user-minus';\n    super.initAttrs(attrs);\n  }\n  getContent() {\n    return m(ErasureRequestsList, {\n      state: this.attrs.state\n    });\n  }\n  goToRoute() {\n    m.route.set(app.route('erasure-requests'));\n  }\n  getUnreadCount() {\n    if (!this.attrs.state.hasItems()) {\n      return app.forum.attribute('erasureRequestCount');\n    }\n    return app.store.all('erasure-requests').length;\n  }\n  getNewCount() {\n    return this.getUnreadCount();\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/ErasureRequestsDropdown', ErasureRequestsDropdown);","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport HeaderSecondary from 'flarum/forum/components/HeaderSecondary';\nimport ErasureRequestsDropdown from '../components/ErasureRequestsDropdown';\nexport default function extendHeaderSecondary() {\n  extend(HeaderSecondary.prototype, 'items', function (items) {\n    if (app.forum.attribute('erasureRequestCount')) {\n      items.add('erasureRequests', m(ErasureRequestsDropdown, {\n        state: app.erasureRequests\n      }), 20);\n    }\n  });\n}\nflarum.reg.add('flarum-gdpr', 'forum/extenders/extendHeaderSecondary', extendHeaderSecondary);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Page');","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Page from 'flarum/common/components/Page';\nexport default function extendPage() {\n  extend(Page.prototype, 'oninit', function () {\n    if (m.route.param('erasureRequestConfirmed')) {\n      app.alerts.show({\n        type: 'success'\n      }, app.translator.trans('flarum-gdpr.forum.erasure_request_confirmed'));\n    }\n  });\n}\nflarum.reg.add('flarum-gdpr', 'forum/extenders/extendPage', extendPage);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/utils/UserControls');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Form from 'flarum/common/components/Form';\nimport app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport username from 'flarum/common/helpers/username';\nimport Button from 'flarum/common/components/Button';\nexport default class DeleteUserModal extends Modal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"user\", void 0);\n    _defineProperty(this, \"loadingAnonymization\", false);\n    _defineProperty(this, \"loadingDeletion\", false);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.user = this.attrs.user;\n  }\n  className() {\n    return 'DeleteUserModal Modal--small';\n  }\n  title() {\n    return app.translator.trans('flarum-gdpr.forum.delete_user.title', {\n      username: username(this.user)\n    });\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(Form, {\n      className: \"Form--centered\"\n    }, m(\"p\", {\n      className: \"helpText\"\n    }, app.translator.trans('flarum-gdpr.forum.delete_user.text', {\n      username: username(this.user)\n    })), m(\"div\", {\n      className: \"Form-group\"\n    }, m(Button, {\n      className: \"Button Button--primary Button--block\",\n      onclick: () => this.defaultErasure(),\n      loading: this.loading,\n      disabled: this.loading\n    }, app.translator.trans('flarum-gdpr.forum.delete_user.modal_delete_button'))), app.forum.attribute('erasureAnonymizationAllowed') && app.forum.attribute('erasureDeletionAllowed') && m(\"div\", null, m(\"div\", {\n      className: \"Form-group\"\n    }, m(Button, {\n      className: \"Button Button--block\",\n      onclick: () => this.specificErasure('anonymization'),\n      loading: this.loadingAnonymization,\n      disabled: this.loadingAnonymization\n    }, app.translator.trans('flarum-gdpr.forum.process_erasure.anonymization_button'))), m(\"div\", {\n      className: \"Form-group\"\n    }, m(Button, {\n      className: \"Button Button--danger Button--block\",\n      onclick: () => this.specificErasure('deletion'),\n      loading: this.loadingDeletion,\n      disabled: this.loadingDeletion\n    }, app.translator.trans('flarum-gdpr.forum.process_erasure.deletion_button'))))));\n  }\n  defaultErasure() {\n    this.loading = true;\n    this.user.delete().then(() => {\n      this.hide();\n      this.loading = false;\n      m.redraw();\n    }, () => {});\n  }\n  specificErasure(mode) {\n    if (mode === 'anonymization') {\n      this.loadingAnonymization = true;\n    } else {\n      this.loadingDeletion = true;\n    }\n    this.user.delete({\n      gdprMode: mode\n    }).then(() => {\n      this.hide();\n      this.loadingAnonymization = false;\n      this.loadingDeletion = false;\n      m.redraw();\n    }, () => []);\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/DeleteUserModal', DeleteUserModal);","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserControls from 'flarum/forum/utils/UserControls';\nimport Button from 'flarum/common/components/Button';\nimport RequestDataExportModal from '../../common/components/RequestDataExportModal';\nimport DeleteUserModal from '../components/DeleteUserModal';\nexport default function extendUserControls() {\n  extend(UserControls, 'moderationControls', function (items, user) {\n    if (user.canModerateExports()) {\n      items.add('gdpr-export', m(Button, {\n        icon: \"fas fa-file-export\",\n        onclick: () => app.modal.show(RequestDataExportModal, {\n          user\n        })\n      }, app.translator.trans('flarum-gdpr.forum.settings.export_data_button')));\n    }\n  });\n  extend(UserControls, 'destructiveControls', function (items, user) {\n    items.remove('delete');\n    if (user.canDelete()) {\n      items.add('gdpr-erase', m(Button, {\n        icon: \"fas fa-eraser\",\n        onclick: () => app.modal.show(DeleteUserModal, {\n          user\n        })\n      }, app.translator.trans('flarum-gdpr.forum.delete_user.delete_button')));\n    }\n  });\n}\nflarum.reg.add('flarum-gdpr', 'forum/extenders/extendUserControls', extendUserControls);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/User');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Badge');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extenders');","import app from 'flarum/forum/app';\nimport Page from 'flarum/common/components/Page';\nimport ErasureRequestsList from './ErasureRequestsList';\nexport default class ErasureRequestsPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n    app.history.push('erasure-requests');\n    app.erasureRequests.load();\n    this.bodyClass = 'App--ErasureRequests';\n  }\n  view() {\n    return m(\"div\", {\n      className: \"ErasureRequestsPage\"\n    }, m(ErasureRequestsList, {\n      state: app.erasureRequests\n    }));\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/ErasureRequestsPage', ErasureRequestsPage);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Model');","import Model from 'flarum/common/Model';\nexport default class ErasureRequest extends Model {\n  status() {\n    return Model.attribute('status').call(this);\n  }\n  reason() {\n    return Model.attribute('reason').call(this);\n  }\n  createdAt() {\n    return Model.attribute('createdAt', Model.transformDate).call(this);\n  }\n  userConfirmedAt() {\n    return Model.attribute('userConfirmedAt', Model.transformDate).call(this);\n  }\n  processedAt() {\n    return Model.attribute('processedAt', Model.transformDate).call(this);\n  }\n  processorComment() {\n    return Model.attribute('processorComment').call(this);\n  }\n  processedMode() {\n    return Model.attribute('processedMode').call(this);\n  }\n  user() {\n    return Model.hasOne('user').call(this);\n  }\n  processedBy() {\n    return Model.hasOne('processedBy').call(this);\n  }\n}\nflarum.reg.add('flarum-gdpr', 'common/models/ErasureRequest', ErasureRequest);","import Model from 'flarum/common/Model';\nexport default class Export extends Model {\n  file() {\n    return Model.attribute('file').call(this);\n  }\n  createdAt() {\n    return Model.attribute('createdAt', Model.transformDate);\n  }\n  destroysAt() {\n    return Model.attribute('destroysAt', Model.transformDate);\n  }\n  user() {\n    return Model.hasOne('user');\n  }\n  actor() {\n    return Model.hasOne('actor');\n  }\n}\nflarum.reg.add('flarum-gdpr', 'common/models/Export', Export);","import Extend from 'flarum/common/extenders';\nimport User from 'flarum/common/models/User';\nimport ErasureRequest from './models/ErasureRequest';\nimport Export from './models/Export';\nexport default [new Extend.Store() //\n.add('user-erasure-requests', ErasureRequest).add('gdpr-exports', Export), new Extend.Model(User) //\n.attribute('canModerateExports').attribute('anonymized').hasOne('erasureRequest')];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/Notification');","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport username from 'flarum/common/helpers/username';\nexport default class ExportAvailableNotification extends Notification {\n  icon() {\n    return 'fas fa-file-export';\n  }\n  href() {\n    const exportModel = this.attrs.notification.subject();\n\n    // Building the full url scheme so that Mithril treats this as an external link, so the download will work correctly.\n    return app.forum.attribute('baseUrl') + \"/gdpr/export/\".concat(exportModel.file());\n  }\n  content() {\n    const notification = this.attrs.notification;\n    return app.translator.trans('flarum-gdpr.forum.notification.export-ready', {\n      username: username(notification.fromUser())\n    });\n  }\n  excerpt() {\n    return null;\n  }\n}\nflarum.reg.add('flarum-gdpr', 'forum/components/ExportAvailableNotification', ExportAvailableNotification);","import Extend from 'flarum/common/extenders';\nimport ErasureRequestsPage from './components/ErasureRequestsPage';\nimport { default as extend } from '../common/extend';\nimport ExportAvailableNotification from './components/ExportAvailableNotification';\nexport default [...extend, new Extend.Routes() //\n.add('erasure-requests', '/erasure-requests', ErasureRequestsPage), new Extend.Notification().add('gdprExportAvailable', ExportAvailableNotification)];","import app from 'flarum/forum/app';\nimport ErasureRequestsListState from './states/ErasureRequestsListState';\nimport extendUserSettingsPage from './extenders/extendUserSettingsPage';\nimport extendHeaderSecondary from './extenders/extendHeaderSecondary';\nimport extendPage from './extenders/extendPage';\nimport extendUserControls from './extenders/extendUserControls';\nimport addAnonymousBadges from './extenders/addAnonymousBadges';\nexport { default as extend } from './extend';\napp.initializers.add('flarum-gdpr', () => {\n  app.erasureRequests = new ErasureRequestsListState();\n  extendUserSettingsPage();\n  extendHeaderSecondary();\n  extendPage();\n  extendUserControls();\n  addAnonymousBadges();\n});","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport User from 'flarum/common/models/User';\nimport Badge from 'flarum/common/components/Badge';\nexport default function () {\n  extend(User.prototype, 'badges', function (badges) {\n    if (this.anonymized()) {\n      badges.add('anonymized', m(Badge, {\n        label: app.translator.trans('flarum-gdpr.forum.badges.anonymized_user'),\n        icon: \"fas fa-user-secret\",\n        type: \"anonymized\"\n      }));\n    }\n  });\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","reg","ErasureRequestsListState","constructor","super","type","load","_app$session$user","user","attribute","this","pages","location","page","length","Promise","resolve","loadNext","add","_typeof","iterator","_defineProperty","e","r","t","i","toPrimitive","TypeError","String","toPropertyKey","configurable","writable","RequestErasureModal","arguments","oninit","vnode","reason","password","className","title","trans","content","m","fields","toArray","_this$user","items","currRequest","erasureRequest","status","concat","onclick","oncancel","bind","loading","bidi","placeholder","oninput","target","rows","redraw","request","method","url","id","then","close","data","onsubmit","preventDefault","createRecord","save","meta","pushData","relationships","catch","RequestDataExportModal","attrs","username","requestExport","disabled","body","attributes","userId","hide","loaded","extendUserSettingsPage","extend","label","dataItems","override","icon","show","ProcessErasureRequestModal","comments","controlsButtonClassName","name","loadingAnonymization","process","loadingDeletion","mode","confirm","processedMode","processorComment","remove","ErasureRequestsList","view","state","controls","controlItems","hasItems","isLoading","emptyText","loadMore","hasNext","isLoadingNext","showModal","getPages","map","index","avatar","datetime","createdAt","excerpt","ErasureRequestsDropdown","initAttrs","getContent","goToRoute","route","set","getUnreadCount","all","getNewCount","extendHeaderSecondary","extendPage","param","DeleteUserModal","defaultErasure","specificErasure","delete","gdprMode","extendUserControls","canModerateExports","canDelete","ErasureRequestsPage","push","bodyClass","ErasureRequest","userConfirmedAt","processedAt","processedBy","Export","file","destroysAt","actor","hasOne","ExportAvailableNotification","href","exportModel","notification","subject","fromUser","badges","anonymized"],"sourceRoot":""}